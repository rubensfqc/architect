{% extends "architect_app/baseClient.html" %}
{% block title %}My Projects Dashboard{% endblock %}

{% block content %}
<h1 class="text-2xl font-semibold mb-6">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8">
    <div>
        <h1 class="text-2xl font-bold text-gray-900">
            Welcome, {{ client.user.get_full_name|default:client.user.email }}
        </h1>
        <p class="text-sm text-gray-500">
            Working with <strong>{{ architect.firm_name }}</strong>
        </p>
    </div>
    
    <div class="mt-4 md:mt-0">
        <span class="px-3 py-1 rounded-full bg-blue-100 text-blue-700 text-xs font-semibold uppercase">
            Client Portal
        </span>
    </div>
</div>

<section class="mb-12">
    <h2 class="text-xl font-semibold mb-2">Seus Contratos</h2>
    <p class="text-gray-500 mb-6 text-sm">Acompanhe aqui a evolução de cada contrato.</p>

    {% for contract in contracts %}
    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 mb-6">
        
        <div class="flex justify-between items-center mb-4">
            <h3 class="font-bold text-gray-800 text-lg">{{ contract.title }}</h3>
            <span class="px-3 py-1 bg-blue-50 text-blue-600 rounded-full text-[10px] font-bold uppercase">
                {{ contract.get_phase_display }}
            </span>
        </div>

        <div class="flex justify-between text-[10px] font-medium text-gray-400 mb-2 uppercase tracking-widest">
            <span class="{% if contract.phase == 'EST' %}text-blue-600 font-bold{% endif %}">Estudo</span>
            <span class="{% if contract.phase == 'ANT' %}text-blue-600 font-bold{% endif %}">Anteprojeto</span>
            <span class="{% if contract.phase == 'EXE' %}text-blue-600 font-bold{% endif %}">Executivo</span>
            <span class="{% if contract.phase == 'FIN' %}text-green-600 font-bold{% endif %}">Finalizado</span>
        </div>
        
        <div class="w-full bg-gray-100 h-2 rounded-full overflow-hidden">
            <div class="bg-blue-600 h-2 rounded-full transition-all duration-700" 
                 style="width: {{ contract.progress_percentage }}%">
            </div>
        </div>

        <div class="mt-2 flex justify-between items-center">
            <span class="text-[10px] text-gray-400">Início: {{ contract.start_date|date:"d/m/Y" }}</span>
            <span class="text-xs font-semibold text-blue-600">{{ contract.progress_percentage }}% concluído</span>
        </div>
    </div>
    {% empty %}
    <div class="bg-white p-8 rounded-2xl border border-dashed border-gray-200 text-center">
        <p class="text-gray-500 italic">Nenhum contrato encontrado para este perfil.</p>
    </div>
    {% endfor %}
</section>

</h1>
<h2 class="text-xl mb-4 text-gray-700">Your Projects</h2>

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for project in projects %}
    <div class="bg-white p-6 rounded-xl shadow border-l-4 border-green-500">
        <h3 class="font-bold text-lg mb-2">{{ project.name }}</h3>
        <p class="text-sm text-gray-600 mb-1"><strong>Location:</strong> {{ project.location }}</p>
        <p class="text-sm text-gray-600"><strong>Status:</strong> 
            {% if project.contract.is_active %} Active {% else %} Inactive {% endif %}
        </p>
        <div class="mt-4 text-xs text-gray-400 uppercase tracking-wider">
            Contract: {{ project.contract.title }}
        </div>
    </div>
    {% empty %}
    <p class="text-gray-500">You currently have no projects listed.</p>
    {% endfor %}
</div>
{% endblock %}